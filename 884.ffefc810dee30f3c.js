"use strict";(self.webpackChunkAIPlayground=self.webpackChunkAIPlayground||[]).push([[884],{6884:(z,g,r)=>{r.r(g),r.d(g,{DigitRecognitionModule:()=>L});var l=r(6895),v=r(9116),h=r(5861),e=r(4650);function m(n){return{x:n.clientX,y:n.clientY}}function p(n){return{x:n.targetTouches[0].clientX,y:n.targetTouches[0].clientY}}let R=(()=>{class n{constructor(t){this.document=t,this.dragging=!1,this.position={x:0,y:0},this.dragEmitter=new e.vpe,this.touchEndEmitter=new e.vpe,t.addEventListener("mousedown",i=>{this.position=m(i),this.touchStart()}),t.addEventListener("touchstart",i=>{this.position=p(i),this.touchStart()}),t.addEventListener("mousemove",i=>{this.position=m(i),this.touchMove()}),t.addEventListener("touchmove",i=>{this.position=p(i),this.touchMove()}),t.addEventListener("mouseup",()=>{this.touchEnd()}),t.addEventListener("touchend",()=>{this.touchEnd()}),t.addEventListener("mouseleave",()=>{this.touchEnd()}),t.addEventListener("touchcancel",()=>{this.touchEnd()})}touchStart(){this.dragging=!0,this.dragEmitter.emit(this.position)}touchMove(){this.dragging&&this.dragEmitter.emit(this.position)}touchEnd(){this.dragging=!1,this.touchEndEmitter.emit()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(l.K0))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var M=r(7056),b=r(1702),S=r(3917),f=r(4859),E=r(7392);const w=["canvasElement"],D=["resizeCanvasElement"];function T(n,s){if(1&n&&(e.TgZ(0,"div",9),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij("I believe this is a ",t.result,"")}}const y=!!function P(){let n=!1;try{let s=Object.defineProperty({},"passive",{get:function(){n=!0}}),t="testPassive",i=null;window.addEventListener(t,i,s),window.removeEventListener(t,i,s)}catch{}return n}()&&{passive:!1},Z=[{path:"",component:(()=>{class n{constructor(t,i,o,u,a){this.touchService=t,this.drawerService=i,this.pythonRunner=o,this.aiReposService=u,this.document=a,this.busy=!0,this.touchStartedInCanvas=!1,this.preventMobileScrolling=this.preventMobileScrolling.bind(this),window.addEventListener("touchmove",this.preventMobileScrolling,y)}ngOnDestroy(){window.removeEventListener("touchmove",this.preventMobileScrolling,y)}ngAfterViewInit(){var t=this;return(0,h.Z)(function*(){let i=t.canvasElement.nativeElement;i.addEventListener("touchstart",()=>{t.touchStartedInCanvas=!0});let o=i.getContext("2d");t.touchService.dragEmitter.subscribe(({x:u,y:a})=>{if(!t.touchStartedInCanvas)return;let c=i.getBoundingClientRect(),d=u-c.left,C=a-c.top;void 0!==t.prevPos&&(o.beginPath(),o.moveTo(t.prevPos.x,t.prevPos.y),o.lineTo(d,C),o.lineWidth=6,o.strokeStyle="black",o.shadowColor="black",o.shadowBlur=4,o.lineCap="round",o.lineJoin="round",o.stroke(),o.closePath()),t.prevPos={x:d,y:C}}),t.touchService.touchEndEmitter.subscribe(()=>{t.prevPos=void 0,t.touchStartedInCanvas=!1}),yield t.pythonRunner.loadScript("digit_recognition"),yield t.aiReposService.loadFromServer("digit_recognition",t.pythonRunner),console.log("Loaded"),t.busy=!1})()}clear(){this.canvasElement.nativeElement.getContext("2d").clearRect(0,0,112,112)}predict(){var t=this;return(0,h.Z)(function*(){console.log("Predicting"),t.busy=!0;let i=t.getResizedImage();t.result=yield t.pythonRunner.run("instance.eval()",{inputs:i}),t.busy=!1})()}getResizedImage(){let t=this.canvasElement.nativeElement,o=this.resizeCanvasElement.nativeElement.getContext("2d");o.clearRect(0,0,28,28),o.drawImage(t,0,0,28,28);let a=o.getImageData(0,0,28,28,{colorSpace:"srgb"}).data.filter((c,d)=>d%4==3);return Array.from(a.values()).map(c=>c/255)}preventMobileScrolling(t){this.touchStartedInCanvas&&t.preventDefault()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(R),e.Y36(M.z),e.Y36(b.Z),e.Y36(S.f),e.Y36(l.K0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-digit-recognition-main"]],viewQuery:function(t,i){if(1&t&&(e.Gf(w,5),e.Gf(D,5)),2&t){let o;e.iGM(o=e.CRH())&&(i.canvasElement=o.first),e.iGM(o=e.CRH())&&(i.resizeCanvasElement=o.first)}},decls:16,vars:2,consts:[[1,"canvas-container"],[1,"d-flex"],["width","112","height","112"],["canvasElement",""],["mat-icon-button","",3,"click"],["width","28","height","28",1,"d-none"],["resizeCanvasElement",""],["mat-raised-button","","color","primary",3,"disabled","click"],["class","ms-1",4,"ngIf"],[1,"ms-1"]],template:function(t,i){1&t&&(e.TgZ(0,"h2"),e._uU(1,"Handwritten Digit Recognition"),e.qZA(),e.TgZ(2,"div",0)(3,"p"),e._uU(4,"Draw a single digit below"),e.qZA(),e.TgZ(5,"div",1),e._UZ(6,"canvas",2,3),e.TgZ(8,"button",4),e.NdJ("click",function(){return i.clear()}),e.TgZ(9,"mat-icon"),e._uU(10,"delete_outline"),e.qZA()()(),e._UZ(11,"canvas",5,6),e.qZA(),e.TgZ(13,"button",7),e.NdJ("click",function(){return i.predict()}),e._uU(14," Predict\n"),e.qZA(),e.YNc(15,T,2,1,"div",8)),2&t&&(e.xp6(13),e.Q6J("disabled",i.busy),e.xp6(2),e.Q6J("ngIf",void 0!==i.result))},directives:[f.lW,E.Hw,l.O5],styles:[".canvas-container[_ngcontent-%COMP%]{margin-bottom:1rem}canvas[_ngcontent-%COMP%]{border:solid black .1rem;background-color:#fff}"]}),n})()}];let I=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[v.Bz.forChild(Z)],v.Bz]}),n})(),L=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[l.ez,I,f.ot,E.Ps]]}),n})()}}]);