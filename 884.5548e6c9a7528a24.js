"use strict";(self.webpackChunkAIPlayground=self.webpackChunkAIPlayground||[]).push([[884],{6884:(A,u,a)=>{a.r(u),a.d(u,{DigitRecognitionModule:()=>Y});var r=a(6895),h=a(9116),v=a(5861),t=a(4650);function m(n){return{x:n.clientX,y:n.clientY}}function p(n){return{x:n.targetTouches[0].clientX,y:n.targetTouches[0].clientY}}let y=(()=>{class n{constructor(e){this.document=e,this.dragging=!1,this.position={x:0,y:0},this.dragEmitter=new t.vpe,this.touchEndEmitter=new t.vpe,e.addEventListener("mousedown",i=>{this.position=m(i),this.touchStart()}),e.addEventListener("touchstart",i=>{this.position=p(i),this.touchStart()}),e.addEventListener("mousemove",i=>{this.position=m(i),this.touchMove()}),e.addEventListener("touchmove",i=>{this.position=p(i),this.touchMove()}),e.addEventListener("mouseup",()=>{this.touchEnd()}),e.addEventListener("touchend",()=>{this.touchEnd()}),e.addEventListener("mouseleave",()=>{this.touchEnd()}),e.addEventListener("touchcancel",()=>{this.touchEnd()})}touchStart(){this.dragging=!0,this.dragEmitter.emit(this.position)}touchMove(){this.dragging&&this.dragEmitter.emit(this.position)}touchEnd(){this.dragging=!1,this.touchEndEmitter.emit()}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(r.K0))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var S=a(7056),M=a(3797),w=a(3917),f=a(4859),E=a(7392);const D=["canvasElement"],b=["resizeCanvasElement"];function T(n,s){1&n&&(t.ynx(0),t._uU(1,"Predict"),t.BQk())}function x(n,s){1&n&&(t.ynx(0),t._uU(1,"Loading"),t.BQk())}function P(n,s){1&n&&(t.ynx(0),t._uU(1,"Predicting"),t.BQk())}function Z(n,s){if(1&n&&(t.TgZ(0,"div",10),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij("I believe this is a ",e.result,"")}}const C=!!function I(){let n=!1;try{let s=Object.defineProperty({},"passive",{get:function(){n=!0}}),e="testPassive",i=null;window.addEventListener(e,i,s),window.removeEventListener(e,i,s)}catch{}return n}()&&{passive:!1},L=[{path:"",component:(()=>{class n{constructor(e,i,o,d,c){this.touchService=e,this.drawerService=i,this.pythonRunner=o,this.aiReposService=d,this.document=c,this.state="idle",this.touchStartedInCanvas=!1,this.preventMobileScrolling=this.preventMobileScrolling.bind(this),window.addEventListener("touchmove",this.preventMobileScrolling,C)}ngOnDestroy(){window.removeEventListener("touchmove",this.preventMobileScrolling,C)}ngAfterViewInit(){var e=this;return(0,v.Z)(function*(){let i=e.canvasElement.nativeElement;i.addEventListener("touchstart",()=>{e.touchStartedInCanvas=!0}),i.addEventListener("mousedown",()=>{e.touchStartedInCanvas=!0});let o=i.getContext("2d");e.touchService.dragEmitter.subscribe(({x:d,y:c})=>{if(!e.touchStartedInCanvas)return;let l=i.getBoundingClientRect(),g=d-l.left,R=c-l.top;void 0!==e.prevPos&&(o.beginPath(),o.moveTo(e.prevPos.x,e.prevPos.y),o.lineTo(g,R),o.lineWidth=6,o.strokeStyle="black",o.shadowColor="black",o.shadowBlur=4,o.lineCap="round",o.lineJoin="round",o.stroke(),o.closePath()),e.prevPos={x:g,y:R}}),e.touchService.touchEndEmitter.subscribe(()=>{e.prevPos=void 0,e.touchStartedInCanvas=!1})})()}clear(){this.canvasElement.nativeElement.getContext("2d").clearRect(0,0,112,112)}predict(){var e=this;return(0,v.Z)(function*(){console.log("Loading"),e.state="loading",yield e.pythonRunner.loadScript("digit_recognition"),yield e.aiReposService.loadModel("digit_recognition",e.pythonRunner),console.log("Predicting"),e.state="predicting";let i=e.getResizedImage();e.result=yield e.pythonRunner.run("instance.eval()",{inputs:i}),e.state="idle"})()}getResizedImage(){let e=this.canvasElement.nativeElement,o=this.resizeCanvasElement.nativeElement.getContext("2d");o.clearRect(0,0,28,28),o.drawImage(e,0,0,28,28);let c=o.getImageData(0,0,28,28,{colorSpace:"srgb"}).data.filter((l,g)=>g%4==3);return Array.from(c.values()).map(l=>l/255)}preventMobileScrolling(e){this.touchStartedInCanvas&&e.preventDefault()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(y),t.Y36(S.z),t.Y36(M.Z),t.Y36(w.f),t.Y36(r.K0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-digit-recognition-main"]],viewQuery:function(e,i){if(1&e&&(t.Gf(D,5),t.Gf(b,5)),2&e){let o;t.iGM(o=t.CRH())&&(i.canvasElement=o.first),t.iGM(o=t.CRH())&&(i.resizeCanvasElement=o.first)}},decls:18,vars:6,consts:[[1,"canvas-container"],[1,"d-flex"],["width","112","height","112"],["canvasElement",""],["mat-icon-button","",3,"click"],["width","28","height","28",1,"d-none"],["resizeCanvasElement",""],["mat-raised-button","","color","primary",3,"disabled","ngSwitch","click"],[4,"ngSwitchCase"],["class","ms-1",4,"ngIf"],[1,"ms-1"]],template:function(e,i){1&e&&(t.TgZ(0,"h2"),t._uU(1,"Handwritten Digit Recognition"),t.qZA(),t.TgZ(2,"div",0)(3,"p"),t._uU(4,"Draw a single digit below"),t.qZA(),t.TgZ(5,"div",1),t._UZ(6,"canvas",2,3),t.TgZ(8,"button",4),t.NdJ("click",function(){return i.clear()}),t.TgZ(9,"mat-icon"),t._uU(10,"delete_outline"),t.qZA()()(),t._UZ(11,"canvas",5,6),t.qZA(),t.TgZ(13,"button",7),t.NdJ("click",function(){return i.predict()}),t.YNc(14,T,2,0,"ng-container",8),t.YNc(15,x,2,0,"ng-container",8),t.YNc(16,P,2,0,"ng-container",8),t.qZA(),t.YNc(17,Z,2,1,"div",9)),2&e&&(t.xp6(13),t.Q6J("disabled","idle"!==i.state)("ngSwitch",i.state),t.xp6(1),t.Q6J("ngSwitchCase","idle"),t.xp6(1),t.Q6J("ngSwitchCase","loading"),t.xp6(1),t.Q6J("ngSwitchCase","predicting"),t.xp6(1),t.Q6J("ngIf",void 0!==i.result))},directives:[f.lW,E.Hw,r.RF,r.n9,r.O5],styles:[".canvas-container[_ngcontent-%COMP%]{margin-bottom:1rem}canvas[_ngcontent-%COMP%]{border:solid black .1rem;background-color:#fff}"]}),n})()}];let z=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[h.Bz.forChild(L)],h.Bz]}),n})(),Y=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[r.ez,z,f.ot,E.Ps]]}),n})()}}]);