"use strict";(self.webpackChunkAIPlayground=self.webpackChunkAIPlayground||[]).push([[884],{6884:(w,g,s)=>{s.r(g),s.d(g,{DigitRecognitionModule:()=>P});var u=s(6895),h=s(9116),v=s(5861),e=s(4650);function m(i){return{x:i.clientX,y:i.clientY}}function p(i){return{x:i.targetTouches[0].clientX,y:i.targetTouches[0].clientY}}let E=(()=>{class i{constructor(t){this.document=t,this.dragging=!1,this.position={x:0,y:0},this.dragEmitter=new e.vpe,this.touchEndEmitter=new e.vpe,t.addEventListener("mousedown",n=>{this.position=m(n),this.touchStart()}),t.addEventListener("touchstart",n=>{this.position=p(n),this.touchStart()}),t.addEventListener("mousemove",n=>{this.position=m(n),this.touchMove()}),t.addEventListener("touchmove",n=>{this.position=p(n),this.touchMove()}),t.addEventListener("mouseup",()=>{this.touchEnd()}),t.addEventListener("touchend",()=>{this.touchEnd()}),t.addEventListener("mouseleave",()=>{this.touchEnd()}),t.addEventListener("touchcancel",()=>{this.touchEnd()})}touchStart(){this.dragging=!0,this.dragEmitter.emit(this.position)}touchMove(){this.dragging&&this.dragEmitter.emit(this.position)}touchEnd(){this.dragging=!1,this.touchEndEmitter.emit()}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(u.K0))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var R=s(7056),C=s(1702),M=s(3917),f=s(4859),y=s(7392);const T=["canvasElement"],b=["resizeCanvasElement"];function D(i,r){if(1&i&&(e.TgZ(0,"div",9),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij("I believe this is a ",t.result,"")}}const S=[{path:"",component:(()=>{class i{constructor(t,n,o,c){this.touchService=t,this.drawerService=n,this.pythonRunner=o,this.aiReposService=c,this.busy=!0}ngAfterViewInit(){var t=this;return(0,v.Z)(function*(){let n=t.canvasElement.nativeElement,o=n.getContext("2d");t.touchService.dragEmitter.subscribe(({x:c,y:d})=>{let a=c-n.offsetLeft-t.drawerService.currentWidth,l=d-n.offsetTop;void 0!==t.prevPos&&(o.beginPath(),o.moveTo(t.prevPos.x,t.prevPos.y),o.lineTo(a,l),o.lineWidth=6,o.strokeStyle="black",o.shadowColor="black",o.shadowBlur=4,o.lineCap="round",o.lineJoin="round",o.stroke(),o.closePath()),t.prevPos={x:a,y:l}}),t.touchService.touchEndEmitter.subscribe(()=>{t.prevPos=void 0}),yield t.pythonRunner.loadScript("digit_recognition"),yield t.aiReposService.loadFromServer("digit_recognition",t.pythonRunner),yield t.pythonRunner.run("instance.echo()",{message:"123"}),console.log("Loaded"),t.busy=!1})()}clear(){this.canvasElement.nativeElement.getContext("2d").clearRect(0,0,112,112)}predict(){var t=this;return(0,v.Z)(function*(){console.log("Predicting"),t.busy=!0;let n=t.getResizedImage();t.result=yield t.pythonRunner.run("instance.eval()",{inputs:n}),t.busy=!1})()}getResizedImage(){let t=this.canvasElement.nativeElement,o=this.resizeCanvasElement.nativeElement.getContext("2d");o.clearRect(0,0,28,28),o.drawImage(t,0,0,28,28);let d=o.getImageData(0,0,28,28,{colorSpace:"srgb"}).data.filter((a,l)=>l%4==3);return Array.from(d.values()).map(a=>a/255)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(E),e.Y36(R.z),e.Y36(C.Z),e.Y36(M.f))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-digit-recognition-main"]],viewQuery:function(t,n){if(1&t&&(e.Gf(T,5),e.Gf(b,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.canvasElement=o.first),e.iGM(o=e.CRH())&&(n.resizeCanvasElement=o.first)}},decls:16,vars:2,consts:[[1,"canvas-container"],[1,"d-flex"],["width","112","height","112"],["canvasElement",""],["mat-icon-button","",3,"click"],["width","28","height","28",1,"d-none"],["resizeCanvasElement",""],["mat-raised-button","","color","primary",3,"disabled","click"],["class","ms-1",4,"ngIf"],[1,"ms-1"]],template:function(t,n){1&t&&(e.TgZ(0,"h2"),e._uU(1,"Handwritten Digit Recognition"),e.qZA(),e.TgZ(2,"div",0)(3,"p"),e._uU(4,"Draw a single digit below"),e.qZA(),e.TgZ(5,"div",1),e._UZ(6,"canvas",2,3),e.TgZ(8,"button",4),e.NdJ("click",function(){return n.clear()}),e.TgZ(9,"mat-icon"),e._uU(10,"delete_outline"),e.qZA()()(),e._UZ(11,"canvas",5,6),e.qZA(),e.TgZ(13,"button",7),e.NdJ("click",function(){return n.predict()}),e._uU(14," Predict\n"),e.qZA(),e.YNc(15,D,2,1,"div",8)),2&t&&(e.xp6(13),e.Q6J("disabled",n.busy),e.xp6(2),e.Q6J("ngIf",void 0!==n.result))},directives:[f.lW,y.Hw,u.O5],styles:[".canvas-container[_ngcontent-%COMP%]{margin-bottom:1rem}canvas[_ngcontent-%COMP%]{border:solid black .1rem;background-color:#fff}"]}),i})()}];let Z=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[h.Bz.forChild(S)],h.Bz]}),i})(),P=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[u.ez,Z,f.ot,y.Ps]]}),i})()}}]);